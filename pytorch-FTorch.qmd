---
output-file: index
title: "<br><br>A Library To Couple PyTorch ML Models With Fortran Climate Models<br><br>"
format:
  revealjs:
    embed-resources: false
    chalkboard: false
    preview-links: auto
    history: false
    highlight-style: a11y
    code-overflow: wrap
    code-line-numbers: true
    logo: https://iccs.cam.ac.uk/files/iccs_ucam_combined_reverse_colour.png
    theme: [dark, custom.scss]
    preview: true
    slide-number: true
revealjs-plugins:
  - attribution
authors:
  - name: Matt Archer
    orcid: 0009-0002-7043-6769
    affiliations: Senior Research Software Engineer <br> `ICCS` - `I`nstitute of `C`omputing for `C`limate `S`cience <br> University of Cambridge
  # - name: Jack Atkinson
  #   orcid: 0000-0001-5001-4812
  #   affiliations: Senior Research Software Engineer <br> ICCS - University of Cambridge
  # - name: Joe Wallwork
  #   orcid: 0000-0002-3646-091X
  #   affiliations: Senior Research Software Engineer <br> ICCS - University of Cambridge
date: "2025-10-23"
bibliography: climate_references.bib
include-in-header:
  - text: |
      <style>
      #title-slide .title {
        font-size: 1.25em;
        color: #fffff;
      }
      #title-slide .authors {
        font-size: 1.0em;
        color: #fffff;
      }
      #title-slide .title::before {
        content: "";
        display: inline-block;
        vertical-align: middle;
        width: 350px;
        height: 100px;
        background: url('./images/logos/FTorch.svg') no-repeat center/contain;
      }
      </style>
---
<!-- ## Precursors {.smaller .nostretch} -->

<!-- :::: {.columns} -->
<!-- ::: {.column width="45%"} -->
<!-- #### Slides and Materials -->

<!-- To access links or follow on your own device these slides can be found at:\ -->
<!-- [jackatkinson.net/slides](https://jackatkinson.net/slides) -->

<!-- ::: {style="text-align: center"} -->
<!-- {{< qrcode https://jackatkinson.net/slides qr7dekity9 width=200 height=200 >}} -->
<!-- ::: -->

<!-- ::: -->
<!-- ::: {.column width="5%"} -->
<!-- ::: -->
<!-- ::: {.column width="50%"} -->
<!-- #### Licensing -->

<!-- Except where otherwise noted, these presentation materials are licensed under the Creative Commons -->
<!-- [Attribution-NonCommercial 4.0 International](https://creativecommons.org/licenses/by-nc/4.0/legalcode) ([CC BY-NC 4.0](https://creativecommons.org/licenses/by-nc/4.0/)) License. -->

<!-- ![]( https://mirrors.creativecommons.org/presskit/buttons/88x31/svg/by-nc.eu.svg ){width=40% fig-align="center"} -->

<!-- Vectors and icons by [SVG Repo](https://www.svgrepo.com) -->
<!-- under [CC0(1.0)](https://creativecommons.org/publicdomain/zero/1.0/deed.en) or -->
<!-- [FontAwesome](https://fontawesome.com/) under [SIL OFL 1.1](http://scripts.sil.org/OFL) -->
<!-- ::: -->
<!-- :::: -->


<!-- =============================================================================== -->

{{< include _intro.qmd >}}

<!-- =============================================================================== -->

{{< include _FTorch.qmd >}}

<!-- {{< include _case_studies.qmd >}} -->

<!-- =============================================================================== -->

{{< include _online_training_autograd.qmd >}}

<!-- =============================================================================== -->


## FTorch: Summary {.smaller}

- Use of ML within traditional numerical models
  - A growing area that presents challenges
- Language interoperation
  - FTorch provides a solution for scientists implementing torch models in Fortran
  - Designed for **computational** _and_ **developer** efficiency
  - Has helped deliver science in climate research and beyond\
    see @heuer2023interpretable, @mansfield2024uncertainty and more.
  <!-- - Built into CESM to allow the userbase access -->
- Exploring options for online training and AD
  - Torch `autograd` and `optimizer` exposed using `iso_c_binding`.
  - Work in progress on setting up online ML training.
- Moving away from TorchScript...

<!-- =============================================================================== -->

## Thanks for Listening {.smaller}

:::: {.columns}

::: {.column style="width:20%; font-size: 85%;"}
Get in touch:
:::
::: {.column style="width: 40%; font-size: 85%;"}
{{< fa pencil >}} \ Matt Archer

<!-- {{< fa solid globe >}} \ [jackatkinson.net](https://jackatkinson.net) -->

{{< fa solid envelope >}} \ [ma595[AT]cam.ac.uk](mailto:jwa34@cam.ac.uk)

{{< fa brands github >}} \ [ma595](https://github.com/ma595)

<!-- {{< fa brands mastodon >}} \ [\@jatkinson1000\@hachyderm.io](https://hachyderm.io/@jatkinson1000) -->
:::
::: {.column style="width: 40%; font-size: 85%;"}
{{< fa pencil >}} \ Jack Atkinson

{{< fa solid globe >}} \ [jackatkinson.net](https://jackatkinson.net)

{{< fa solid envelope >}} \ [jwa34[AT]cam.ac.uk](mailto:jwa34@cam.ac.uk)

{{< fa brands github >}} \ [jatkinson1000](https://github.com/jatkinson1000)

{{< fa brands mastodon >}} \ [\@jatkinson1000\@hachyderm.io](https://hachyderm.io/@jatkinson1000)
:::


<!-- ::: {.column style="width: 40%; font-size: 85%;"}
{{< fa pencil >}} \ Joe Wallwork

{{< fa solid globe >}} \ [joewallwork.com](https://joewallwork.com)

{{< fa solid envelope >}} \ [jw2423[AT]cam.ac.uk](mailto:jw2423@cam.ac.uk)

{{< fa brands github >}} \ [jwallwork23](https://github.com/jwallwork23)
::: -->
::::

\

:::: {.columns}

::: {.column style="width:70%;"}
Thanks to `Jack Atkinson`, `Joe Wallwork`, Tom Meltzer, \
Elliott Kasoar, Niccol√≤ Zanotti and the rest of the FTorch team.

The ICCS received support from ![]( ./images/logos/schmidt_science.png ){height=2.4em style="margin: 0; vertical-align: -2%"}

FTorch has been supported by ![]( ./images/logos/c2d3_logo.png ){height=1.4em style="margin: 0; vertical-align: -2%"}
:::
::: {.column style="width:30%; font-size: 85%;"}
[{{< fa brands github >}}/Cambridge-ICCS/FTorch](https://github.com/Cambridge-ICCS/FTorch)

{{< qrcode https://github.com/Cambridge-ICCS/FTorch width=150 height=150 >}}
:::
::::

![](./images/logos/FTorch.svg){style="width: 12%;" .absolute bottom=28% right=2%}

![](https://iccs.cam.ac.uk/files/logo2_2.png){style="width: 12%;" .absolute bottom=19% right=2%}


## References

::: {#refs}
:::

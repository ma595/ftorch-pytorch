# Applications and Case Studies


## MiMA - proof of concept {.smaller}

- The origins of FTorch
  - Emulation of existing parameterisation
  - Coupled to an atmospheric model using `forpy` in @espinosa2022machine^[Originally written in TensorFlow...]
  - Prohibitively slow and hard to implement
  - Asked for a faster, user-friendly implementation that can be used in future studies.

\

- Follow up paper using FTorch: *Uncertainty Quantification of a Machine Learning Subgrid-Scale Parameterization for Atmospheric Gravity Waves* [@mansfield2024uncertainty]
  - "Identical" offline networks have very different behaviours when deployed online.

::: aside
Model of an idealised Moist Atmosphere online at [{{< fa brands github >}}/DataWaveProject/MiMA-machine-learning](https://github.com/DataWaveProject/MiMA-machine-learning)
:::


## ICON {.smaller}

- Icosahedral Nonhydrostatic Weather and Climate Model
  - Developed by DKRZ (Deutsches Klimarechenzentrum)
  - Used by the DWD and Meteo-Swiss

::::{.columns}
:::{.column width=75%}
- *Interpretable multiscale Machine Learning-Based Parameterizations of Convection for ICON* [@heuer2023interpretable]^[Work without direct involvement of ICCS - success on 'ease of use' of FTorch]
  - Train U-Net convection scheme on high-res simulation
  - Deploy in ICON via FTorch coupling
  - Evaluate physical realism (causality) using SHAP values
  - Online stability improved when non-causal relations are eliminated from the net
:::
::::
![]( ./images/parameterisation/Heuer_SHAP.jpg ){.absolute top=45% right=0 width=27%}

![]( ./images/logos/ICON.png ){style="border-radius: 5%;" .absolute top=15% right=0 width=27%}

::: aside
Running on JUWELS at the JÃ¼lich Supercomputing Centre;
ICON Model is now available at [gitlab.dkrz.de/icon/icon-model](https://gitlab.dkrz.de/icon/icon-model)\
:::

## ICON {.smaller}

:::: {.columns}
::: {.column .v-center-container style="width: 100%; text-align: center;"}

![Slide from the [Cambridge Hybrid Modelling Workshop](https://cambridge-iccs.github.io/ml-coupling-workshop) courtesy of Julien Savre](./images/FTorch_ICON.jpg){width=70%}
:::
::::

<div style="position: relative; width: 600px; height: 400px;">
  <svg style="position: absolute; left: 0; top: 0; pointer-events: none;" width="600" height="400">
    <defs>
      <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
        <polygon points="0 0, 10 3.5, 0 7" fill="red"/>
      </marker>
    </defs>
    <line x1="120" y1="350" x2="320" y2="150" stroke="red" stroke-width="4"
          marker-end="url(#arrowhead)" />
  </svg>
</div>



## CESM coupling {.smaller}

- The Community Earth System Model
- Part of [CMIP](https://wcrp-cmip.org/) (Coupled Model Intercomparison Project)
- Make it easy for users
  - FTorch integrated into the build system (CIME)
    - [{{< fa brands github >}}/Cambridge-ICCS/cime_je](https://github.com/Cambridge-ICCS/cime_je)
  - `libtorch` is included on the software stack on Derecho
    - Improves reproducibility

![]( https://www.hpcwire.com/wp-content/uploads/2022/03/derecho-ncar-render.png ){.absolute top=15% right=0% height=20%}

:::{.aside}
Work done with Will Chapman and Jim Edwards of NCAR.\
CIME with FTorch is available with instructions [{{< fa brands github >}}/Cambridge-ICCS/cime_je](https://github.com/Cambridge-ICCS/cime_je)
:::

:::{.attribution}
Derecho by NCAR
:::


## Others {.smaller}

::::{.columns style="font-size: 90%;"}
:::{.column style="width: 45%"}
- To replace a BiCGStab bottleneck in the `GloSea6` Seasonal Forecasting model\
  [@park2025utilization].
- Bias correction of `CESM` through learning model biases compared to ERA5\
  [@chapman2025improving]
- Implementation of nonlinear interactions in the `WaveWatch III` model\
  [@ikuyajolu2025nlml].
- Stable embedding of a convection resolving parameterisation in `E3SM`\
  [@hu2025stable].
:::
:::{.column style="width: 5%;"}
:::
:::{.column style="width: 45%"}
- ClimSim Convection scheme in `ICON` for stable 20-year AMIP run\
  [@heuer2025beyond] (preprint)
- Review paper of hybrid modelling approaches\
  [@zheng2025machine] (preprint)
- Implementation of a new convection trigger in the `CAM` model.\
  Miller et al. In Preparation.
- Embedding of ML schemes for gravity waves in the `CAM` model.\
  ICCS & DataWave.
:::
::::
